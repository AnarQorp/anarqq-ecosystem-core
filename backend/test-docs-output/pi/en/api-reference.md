# Pi Integration API Reference

## Overview

Complete API reference for Pi Network integration with the AnarQ&Q ecosystem.

## PiIntegrationLayer

### Constructor

```javascript
new PiIntegrationLayer(options)
```

**Parameters:**
- `options` (Object): Configuration options
  - `environment` (string): Pi environment (sandbox/testnet/mainnet)
  - `eventBus` (EventBusService): Event bus instance
  - `observability` (ObservabilityService): Observability service

### Methods

#### `initialize()`

Initializes the Pi integration service.

**Returns:** `Promise<void>`

```javascript
await piIntegration.initialize();
```

#### `setEnvironment(environment)`

Sets the Pi Network environment.

**Parameters:**
- `environment` (string): Target environment (sandbox/testnet/mainnet)

```javascript
piIntegration.setEnvironment('testnet');
```

#### `integratePiWallet(qwalletInstance, piCredentials)`

Integrates Pi Wallet with Qwallet.

**Parameters:**
- `qwalletInstance` (Object): Qwallet instance
- `piCredentials` (Object): Pi Network credentials
  - `piUserId` (string): Pi user ID
  - `accessToken` (string): Pi access token
  - `walletAddress` (string): Pi wallet address

**Returns:** `Promise<IntegrationResult>`

```javascript
const result = await piIntegration.integratePiWallet(qwallet, {
  piUserId: 'pi_user_123',
  accessToken: 'token_xyz',
  walletAddress: '0x...'
});
```

#### `linkPiIdentity(squidId, piUserId, options)`

Links Pi identity with sQuid.

**Parameters:**
- `squidId` (string): sQuid identity ID
- `piUserId` (string): Pi user ID
- `options` (Object): Linking options
  - `verificationMethod` (string): Verification method
  - `expiresIn` (string): Expiration time

**Returns:** `Promise<LinkingResult>`

#### `deployPiSmartContract(contractCode, qflowWorkflow)`

Deploys Pi smart contract.

**Parameters:**
- `contractCode` (string): Contract code
- `qflowWorkflow` (Object): Qflow configuration

**Returns:** `Promise<DeploymentResult>`

#### `executePiTransaction(transactionData, qflowContext)`

Executes Pi transaction.

**Parameters:**
- `transactionData` (Object): Transaction data
- `qflowContext` (Object): Qflow context

**Returns:** `Promise<TransactionResult>`

## Data Types

### IntegrationResult

```typescript
interface IntegrationResult {
  success: boolean;
  integrationId?: string;
  status?: string;
  features?: string[];
  balances?: {
    pi: number;
    qtoken: number;
  };
  error?: string;
}
```

### LinkingResult

```typescript
interface LinkingResult {
  success: boolean;
  bindingId?: string;
  bindingHash?: string;
  status?: string;
  expiresAt?: string;
  error?: string;
}
```

### DeploymentResult

```typescript
interface DeploymentResult {
  success: boolean;
  contractId?: string;
  contractAddress?: string;
  deploymentTxHash?: string;
  gasUsed?: number;
  gasEstimate?: GasEstimate;
  status?: string;
  error?: string;
}
```

### TransactionResult

```typescript
interface TransactionResult {
  success: boolean;
  transactionId?: string;
  txHash?: string;
  status?: string;
  requiredConfirmations?: number;
  qflowContext?: QflowContext;
  error?: string;
}
```

## Error Codes

| Code | Description |
|-------|-------------|
| `PI_INVALID_CREDENTIALS` | Invalid Pi credentials |
| `PI_INTEGRATION_NOT_FOUND` | Pi integration not found |
| `PI_IDENTITY_BINDING_FAILED` | Identity binding failed |
| `PI_CONTRACT_DEPLOYMENT_FAILED` | Contract deployment failed |
| `PI_TRANSACTION_FAILED` | Pi transaction failed |
| `PI_INSUFFICIENT_PERMISSIONS` | Insufficient permissions |
| `PI_ENVIRONMENT_NOT_SUPPORTED` | Environment not supported |

---

*Last Updated: 2025-08-31T09:42:47.564Z*  
*Generated by: DocumentationGenerator v1.0.0*
