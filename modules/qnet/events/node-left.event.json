{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schemas.anarq.io/qnet/events/node-left.json",
  "title": "Node Left Event",
  "description": "Event published when a node leaves the QNET network",
  "type": "object",
  "properties": {
    "eventType": {
      "type": "string",
      "const": "q.qnet.node.left.v1"
    },
    "eventId": {
      "type": "string",
      "format": "uuid",
      "description": "Unique event identifier"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Event timestamp"
    },
    "nodeId": {
      "type": "string",
      "pattern": "^qnet-[a-z0-9-]+$",
      "description": "Node identifier that left"
    },
    "nodeName": {
      "type": "string",
      "description": "Human-readable node name"
    },
    "region": {
      "type": "string",
      "enum": [
        "us-east-1", "us-west-1", "us-west-2",
        "eu-west-1", "eu-central-1",
        "ap-southeast-1", "ap-northeast-1",
        "global", "dev"
      ],
      "description": "Node region"
    },
    "reason": {
      "type": "string",
      "enum": [
        "maintenance", "failure", "shutdown", "upgrade", 
        "timeout", "manual", "unknown"
      ],
      "description": "Reason for leaving"
    },
    "graceful": {
      "type": "boolean",
      "description": "Whether the departure was graceful"
    },
    "lastSeen": {
      "type": "string",
      "format": "date-time",
      "description": "Last time node was seen active"
    },
    "finalMetrics": {
      "type": "object",
      "properties": {
        "uptime": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "totalRequests": {
          "type": "integer",
          "minimum": 0
        },
        "totalErrors": {
          "type": "integer",
          "minimum": 0
        }
      },
      "description": "Final node metrics before leaving"
    },
    "replacementNode": {
      "type": "string",
      "pattern": "^qnet-[a-z0-9-]+$",
      "description": "Replacement node ID if applicable"
    },
    "metadata": {
      "type": "object",
      "additionalProperties": true,
      "description": "Additional departure metadata"
    }
  },
  "required": [
    "eventType", "eventId", "timestamp", "nodeId", 
    "region", "reason", "graceful"
  ],
  "additionalProperties": false
}