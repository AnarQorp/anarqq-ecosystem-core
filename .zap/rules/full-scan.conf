# OWASP ZAP Full Scan Configuration
# This configuration defines comprehensive security scanning rules

# Include all baseline rules
INCLUDE baseline.conf

# Advanced vulnerability detection
FAIL 20012 .* "Anti CSRF Tokens Scanner"
FAIL 20014 .* "HTTP Parameter Pollution scanner"
FAIL 20015 .* "Heartbleed OpenSSL Vulnerability"
FAIL 20016 .* "Cross-Domain Misconfiguration"
FAIL 20017 .* "Source Code Disclosure - CVE-2012-1823"
FAIL 20018 .* "Remote Code Execution - CVE-2012-1823"
FAIL 20019 .* "External Redirect"

# Advanced injection attacks
FAIL 90018 .* "SQL Injection - SQLite"
FAIL 90019 .* "Code Injection"
FAIL 90020 .* "Command Injection"
FAIL 90021 .* "XPath Injection"
FAIL 90022 .* "Application Error Disclosure"
FAIL 90023 .* "XML External Entity Attack"
FAIL 90024 .* "Generic Padding Oracle"
FAIL 90025 .* "Expression Language Injection"
FAIL 90026 .* "SOAP Action Spoofing"
FAIL 90027 .* "Cookie Slack Detector"
FAIL 90028 .* "Insecure JSF ViewState"
FAIL 90029 .* "LDAP Injection"
FAIL 90030 .* "WSDL File Detection"

# Business logic vulnerabilities
FAIL 0 .*\/api\/qwallet\/.*\?amount=-[0-9]+ .* "Negative amount in payment API"
FAIL 0 .*\/api\/qwallet\/.*\?amount=0 .* "Zero amount in payment API"
FAIL 0 .*\/api\/qonsent\/.*\?grant=.* .* "Permission escalation attempt"
FAIL 0 .*\/api\/squid\/.*\?identity=admin .* "Admin identity spoofing attempt"

# Authentication and session management
FAIL 10040 .* "Secure Pages Include Mixed Content"
FAIL 10041 .* "HTTP to HTTPS Insecure Transition in Form Post"
FAIL 10042 .* "HTTPS to HTTP Insecure Transition in Form Post"
FAIL 10043 .* "User Controllable JavaScript Event (XSS)"
FAIL 10044 .* "User Controllable HTML Element Attribute (Potential XSS)"
FAIL 10045 .* "Source Code Disclosure - /WEB-INF folder"

# Advanced XSS detection
FAIL 40012 .* "Cross Site Scripting (Reflected)"
FAIL 40013 .* "Session Fixation"
FAIL 40014 .* "Cross Site Scripting (Persistent)"
FAIL 40016 .* "Cross Site Scripting (Persistent) - Prime"
FAIL 40017 .* "Cross Site Scripting (Persistent) - Spider"
FAIL 40018 .* "SQL Injection"

# API security specific rules
FAIL 0 .*\/api\/.*\?.*\{\{.*\}\} .* "Template injection in API"
FAIL 0 .*\/api\/.*\?.*\$\{.*\} .* "Expression language injection in API"
FAIL 0 .*\/api\/.*\?.*\<\%.*\%\> .* "Server-side template injection"
FAIL 0 .*\/api\/.*\?.*file:\/\/ .* "Local file inclusion in API"
FAIL 0 .*\/api\/.*\?.*http:\/\/ .* "Server-side request forgery in API"
FAIL 0 .*\/api\/.*\?.*https:\/\/ .* "Server-side request forgery in API"

# Cryptographic vulnerabilities
FAIL 90024 .* "Generic Padding Oracle"
FAIL 0 .*\/api\/qlock\/.*\?.*algorithm=md5 .* "Weak cryptographic algorithm"
FAIL 0 .*\/api\/qlock\/.*\?.*algorithm=sha1 .* "Weak cryptographic algorithm"
FAIL 0 .*\/api\/qlock\/.*\?.*keysize=512 .* "Weak key size"
FAIL 0 .*\/api\/qlock\/.*\?.*keysize=1024 .* "Weak key size"

# Data exposure vulnerabilities
FAIL 0 .*\/api\/.*\?.*\.\.\/\.\.\/etc\/passwd .* "Path traversal to system files"
FAIL 0 .*\/api\/.*\?.*\.\.\/\.\.\/windows\/system32 .* "Path traversal to system files"
FAIL 0 .*\/api\/.*\?.*backup .* "Backup file exposure"
FAIL 0 .*\/api\/.*\?.*\.bak .* "Backup file exposure"
FAIL 0 .*\/api\/.*\?.*\.old .* "Old file exposure"

# Q ecosystem specific vulnerabilities
FAIL 0 .*\/api\/qindex\/.*\?.*key=\* .* "Wildcard key access attempt"
FAIL 0 .*\/api\/qerberos\/.*\?.*bypass=true .* "Audit bypass attempt"
FAIL 0 .*\/api\/qmask\/.*\?.*profile=none .* "Privacy profile bypass"
FAIL 0 .*\/api\/qdrive\/.*\?.*path=\/ .* "Root directory access attempt"
FAIL 0 .*\/api\/qmarket\/.*\?.*price=0 .* "Zero price manipulation"

# Rate limiting and DoS protection
WARN 0 .*\/api\/.* "Rate limiting not detected"
FAIL 0 .*\/api\/.*\?.*sleep\([0-9]+\) .* "Sleep injection attempt"
FAIL 0 .*\/api\/.*\?.*benchmark\( .* "Benchmark injection attempt"

# Advanced authentication bypass
FAIL 0 .*\/api\/.*\?.*x-squid-id=.* .* "Identity header manipulation"
FAIL 0 .*\/api\/.*\?.*x-qonsent=.* .* "Consent header manipulation"
FAIL 0 .*\/api\/.*\?.*x-sig=.* .* "Signature header manipulation"