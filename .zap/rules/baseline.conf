# OWASP ZAP Baseline Scan Configuration
# This configuration defines rules for baseline security scanning

# Ignore false positives and expected behaviors
# Format: IGNORE (WARN|INFO|FAIL) <rule-id> <url-pattern> <description>

# Ignore development/test specific endpoints
IGNORE WARN 10021 http://localhost:3000/api/.*/health "Health check endpoints"
IGNORE WARN 10021 http://localhost:3000/api/.*/metrics "Metrics endpoints"
IGNORE INFO 10015 http://localhost:3000/api/.*/docs "API documentation endpoints"

# Ignore expected security headers in development
IGNORE INFO 10016 http://localhost:3000/.* "Incomplete or No Cache-control Header Set"
IGNORE INFO 10017 http://localhost:3000/.* "Cross-Domain JavaScript Source File Inclusion"

# Authentication and authorization rules
FAIL 40012 .* "Cross Site Scripting (Reflected)"
FAIL 40014 .* "Cross Site Scripting (Persistent)"
FAIL 40016 .* "Cross Site Scripting (Persistent) - Prime"
FAIL 40017 .* "Cross Site Scripting (Persistent) - Spider"
FAIL 90019 .* "Server Side Code Injection"
FAIL 90020 .* "Remote OS Command Injection"
FAIL 7 .* "Remote File Inclusion"

# SQL Injection rules
FAIL 40018 .* "SQL Injection"
FAIL 40019 .* "SQL Injection - MySQL"
FAIL 40020 .* "SQL Injection - Hypersonic SQL"
FAIL 40021 .* "SQL Injection - Oracle"
FAIL 40022 .* "SQL Injection - PostgreSQL"

# Authentication bypass rules
FAIL 10105 .* "Weak Authentication Method"
FAIL 40013 .* "Session Fixation"
FAIL 40014 .* "Cross Site Request Forgery"

# Information disclosure rules
WARN 10049 .* "Content Cacheability"
WARN 10050 .* "Retrieved from Cache"
WARN 10054 .* "Cookie Without SameSite Attribute"
WARN 10055 .* "CSP Scanner"

# Custom rules for Q ecosystem
FAIL 0 .*\/api\/.*\?.*<script .* "XSS in API parameters"
FAIL 0 .*\/api\/.*\?.*javascript: .* "JavaScript injection in API parameters"
FAIL 0 .*\/api\/.*\?.*eval\( .* "Code injection in API parameters"

# Security headers validation
WARN 10020 .* "X-Frame-Options Header Not Set"
WARN 10021 .* "X-Content-Type-Options Header Missing"
WARN 10023 .* "Information Disclosure - Debug Error Messages"
WARN 10024 .* "Information Disclosure - Sensitive Information in URL"
WARN 10025 .* "Information Disclosure - Sensitive Information in HTTP Referrer Header"

# API-specific security rules
FAIL 0 .*\/api\/.*\.(json|xml)\?.*\.\.\/ .* "Path traversal in API endpoints"
FAIL 0 .*\/api\/.*\?.*union.*select .* "SQL injection attempt in API"
FAIL 0 .*\/api\/.*\?.*<\?php .* "PHP code injection in API"